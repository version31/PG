!function(){var j={},i=function(a){for(var v=j[a],u=v.deps,t=v.defn,s=u.length,r=new Array(s),q=0;q<s;++q){r[q]=o(u[q])}var d=t.apply(null,r);if(void 0===d){throw"module ["+a+"] returned undefined"}v.instance=d},p=function(a,f,e){if("string"!=typeof a){throw"module id must be a string"}if(void 0===f){throw"no dependencies for "+a}if(void 0===e){throw"no definition function for "+a}j[a]={deps:f,defn:e,instance:void 0}},o=function(b){var a=j[b];if(void 0===a){throw"module ["+b+"] was undefined"}return void 0===a.instance&&i(b),a.instance},n=function(g,d){for(var r=g.length,q=new Array(r),h=0;h<r;++h){q.push(o(g[h]))}d.apply(null,d)},m={};m.bolt={module:{api:{define:p,require:n,demand:o}}};var l=p,k=function(d,c){l(d,[],function(){return c})};k("7",tinymce.util.Tools.resolve),l("1",["7"],function(b){return b("tinymce.html.DomParser")}),l("2",["7"],function(b){return b("tinymce.html.Node")}),l("3",["7"],function(b){return b("tinymce.html.Serializer")}),l("4",["7"],function(b){return b("tinymce.PluginManager")}),l("5",["7"],function(b){return b("tinymce.util.Tools")}),l("6",["5"],function(e){var d=function(a,g){return e.each(a,function(b){g=g.replace(b,function(c){return"<!--mce:protected "+escape(c)+"-->"})}),g},f=function(b){return b.replace(/<!--mce:protected ([\s\S]*?)-->/g,function(g,c){return unescape(c)})};return{protectHtml:d,unprotectHtml:f}}),l("0",["1","2","3","4","5","6"],function(h,g,t,s,r,q){return s.add("fullpage",function(z){function y(){var d=x();z.windowManager.open({title:"Document properties",data:d,defaults:{type:"textbox",size:40},body:[{name:"title",label:"Title"},{name:"keywords",label:"Keywords"},{name:"description",label:"Description"},{name:"robots",label:"Robots"},{name:"author",label:"Author"},{name:"docencoding",label:"Encoding"}],onSubmit:function(A){w(r.extend(d,A.data))}})}function x(){function A(F,E){var G=F.attr(E);return G||""}var d,D,C=v(),B={};return B.fontface=z.getParam("fullpage_default_fontface",""),B.fontsize=z.getParam("fullpage_default_fontsize",""),d=C.firstChild,7==d.type&&(B.xml_pi=!0,D=/encoding="([^"]+)"/.exec(d.value),D&&(B.docencoding=D[1])),d=C.getAll("#doctype")[0],d&&(B.doctype="<!DOCTYPE"+d.value+">"),d=C.getAll("title")[0],d&&d.firstChild&&(B.title=d.firstChild.value),a(C.getAll("meta"),function(F){var E,H=F.attr("name"),G=F.attr("http-equiv");H?B[H.toLowerCase()]=F.attr("content"):"Content-Type"==G&&(E=/charset\s*=\s*(.*)\s*/gi.exec(F.attr("content")),E&&(B.docencoding=E[1]))}),d=C.getAll("html")[0],d&&(B.langcode=A(d,"lang")||A(d,"xml:lang")),B.stylesheets=[],r.each(C.getAll("link"),function(E){"stylesheet"==E.attr("rel")&&B.stylesheets.push(E.attr("href"))}),d=C.getAll("body")[0],d&&(B.langdir=A(d,"dir"),B.style=A(d,"style"),B.visited_color=A(d,"vlink"),B.link_color=A(d,"link"),B.active_color=A(d,"alink")),B}function w(I){function H(K,J,L){K.attr(J,L?L:void 0)}function G(J){E.firstChild?E.insert(J,E.firstChild):E.append(J)}var F,E,D,C,B,A=z.dom;F=v(),E=F.getAll("head")[0],E||(C=F.getAll("html")[0],E=new g("head",1),C.firstChild?C.insert(E,C.firstChild,!0):C.append(E)),C=F.firstChild,I.xml_pi?(B='version="1.0"',I.docencoding&&(B+=' encoding="'+I.docencoding+'"'),7!=C.type&&(C=new g("xml",7),F.insert(C,F.firstChild,!0)),C.value=B):C&&7==C.type&&C.remove(),C=F.getAll("#doctype")[0],I.doctype?(C||(C=new g("#doctype",10),I.xml_pi?F.insert(C,F.firstChild):G(C)),C.value=I.doctype.substring(9,I.doctype.length-1)):C&&C.remove(),C=null,a(F.getAll("meta"),function(J){"Content-Type"==J.attr("http-equiv")&&(C=J)}),I.docencoding?(C||(C=new g("meta",1),C.attr("http-equiv","Content-Type"),C.shortEnded=!0,G(C)),C.attr("content","text/html; charset="+I.docencoding)):C&&C.remove(),C=F.getAll("title")[0],I.title?(C?C.empty():(C=new g("title",1),G(C)),C.append(new g("#text",3)).value=I.title):C&&C.remove(),a("keywords,description,author,copyright,robots".split(","),function(N){var M,L,K=F.getAll("meta"),J=I[N];for(M=0;M<K.length;M++){if(L=K[M],L.attr("name")==N){return void (J?L.attr("content",J):L.remove())}}J&&(C=new g("meta",1),C.attr("name",N),C.attr("content",J),C.shortEnded=!0,G(C))});var d={};r.each(F.getAll("link"),function(J){"stylesheet"==J.attr("rel")&&(d[J.attr("href")]=J)}),r.each(I.stylesheets,function(J){d[J]||(C=new g("link",1),C.attr({rel:"stylesheet",text:"text/css",href:J}),C.shortEnded=!0,G(C)),delete d[J]}),r.each(d,function(J){J.remove()}),C=F.getAll("body")[0],C&&(H(C,"dir",I.langdir),H(C,"style",I.style),H(C,"vlink",I.visited_color),H(C,"link",I.link_color),H(C,"alink",I.active_color),A.setAttribs(z.getBody(),{style:I.style,dir:I.dir,vLink:I.visited_color,link:I.link_color,aLink:I.active_color})),C=F.getAll("html")[0],C&&(H(C,"lang",I.langcode),H(C,"xml:lang",I.langcode)),E.firstChild||E.remove(),D=new t({validate:!1,indent:!0,apply_source_formatting:!0,indent_before:"head,html,body,meta,title,script,link,style",indent_after:"head,html,body,meta,title,script,link,style"}).serialize(F),c=D.substring(0,D.indexOf("</body>"))}function v(){return new h({validate:!1,root_name:"#document"}).parse(c)}function u(I){function H(K){return K.replace(/<\/?[A-Z]+/g,function(L){return L.toLowerCase()})}var G,F,E,D,C,B="",A=z.dom;if(!(I.selection||(E=q.protectHtml(z.settings.protect,I.content),"raw"==I.format&&c||I.source_view&&z.getParam("fullpage_hide_in_source_view")))){0!==E.length||I.source_view||(E=r.trim(c)+"\n"+r.trim(E)+"\n"+r.trim(b)),E=E.replace(/<(\/?)BODY/gi,"<$1body"),G=E.indexOf("<body"),G!=-1?(G=E.indexOf(">",G),c=H(E.substring(0,G+1)),F=E.indexOf("</body",G),F==-1&&(F=E.length),I.content=r.trim(E.substring(G+1,F)),b=H(E.substring(F))):(c=f(),b="\n</body>\n</html>"),D=v(),a(D.getAll("style"),function(K){K.firstChild&&(B+=K.firstChild.value)}),C=D.getAll("body")[0],C&&A.setAttribs(z.getBody(),{style:C.attr("style")||"",dir:C.attr("dir")||"",vLink:C.attr("vlink")||"",link:C.attr("link")||"",aLink:C.attr("alink")||""}),A.remove("fullpage_styles");var d=z.getDoc().getElementsByTagName("head")[0];B&&(A.add(d,"style",{id:"fullpage_styles"},B),C=A.get("fullpage_styles"),C.styleSheet&&(C.styleSheet.cssText=B));var J={};r.each(d.getElementsByTagName("link"),function(K){"stylesheet"==K.rel&&K.getAttribute("data-mce-fullpage")&&(J[K.href]=K)}),r.each(D.getAll("link"),function(L){var K=L.attr("href");return !K||(J[K]||"stylesheet"!=L.attr("rel")||A.add(d,"link",{rel:"stylesheet",text:"text/css",href:K,"data-mce-fullpage":"1"}),void delete J[K])}),r.each(J,function(K){K.parentNode.removeChild(K)})}}function f(){var A,d="",B="";return z.getParam("fullpage_default_xml_pi")&&(d+='<?xml version="1.0" encoding="'+z.getParam("fullpage_default_encoding","ISO-8859-1")+'" ?>\n'),d+=z.getParam("fullpage_default_doctype","<!DOCTYPE html>"),d+="\n<html>\n<head>\n",(A=z.getParam("fullpage_default_title"))&&(d+="<title>"+A+"</title>\n"),(A=z.getParam("fullpage_default_encoding"))&&(d+='<meta http-equiv="Content-Type" content="text/html; charset='+A+'" />\n'),(A=z.getParam("fullpage_default_font_family"))&&(B+="font-family: "+A+";"),(A=z.getParam("fullpage_default_font_size"))&&(B+="font-size: "+A+";"),(A=z.getParam("fullpage_default_text_color"))&&(B+="color: "+A+";"),d+="</head>\n<body"+(B?' style="'+B+'"':"")+">\n"}function e(d){d.selection||d.source_view&&z.getParam("fullpage_hide_in_source_view")||(d.content=q.unprotectHtml(r.trim(c)+"\n"+r.trim(d.content)+"\n"+r.trim(b)))}var c,b,a=r.each;z.addCommand("mceFullPageProperties",y),z.addButton("fullpage",{title:"Document properties",cmd:"mceFullPageProperties"}),z.addMenuItem("fullpage",{text:"Document properties",cmd:"mceFullPageProperties",context:"file"}),z.on("BeforeSetContent",u),z.on("GetContent",e)}),function(){}}),o("0")()}();