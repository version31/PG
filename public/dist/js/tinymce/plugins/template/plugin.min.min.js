!function(){var j={},i=function(a){for(var v=j[a],u=v.deps,t=v.defn,s=u.length,r=new Array(s),q=0;q<s;++q){r[q]=o(u[q])}var d=t.apply(null,r);if(void 0===d){throw"module ["+a+"] returned undefined"}v.instance=d},p=function(a,f,e){if("string"!=typeof a){throw"module id must be a string"}if(void 0===f){throw"no dependencies for "+a}if(void 0===e){throw"no definition function for "+a}j[a]={deps:f,defn:e,instance:void 0}},o=function(b){var a=j[b];if(void 0===a){throw"module ["+b+"] was undefined"}return void 0===a.instance&&i(b),a.instance},n=function(g,d){for(var r=g.length,q=new Array(r),h=0;h<r;++h){q.push(o(g[h]))}d.apply(null,d)},m={};m.bolt={module:{api:{define:p,require:n,demand:o}}};var l=p,k=function(d,c){l(d,[],function(){return c})};k("6",tinymce.util.Tools.resolve),l("1",["6"],function(b){return b("tinymce.dom.DOMUtils")}),l("2",["6"],function(b){return b("tinymce.PluginManager")}),l("3",["6"],function(b){return b("tinymce.util.JSON")}),l("4",["6"],function(b){return b("tinymce.util.Tools")}),l("5",["6"],function(b){return b("tinymce.util.XHR")}),l("0",["1","2","3","4","5"],function(g,f,r,q,h){return f.add("template",function(a){function u(b){return function(){var v=a.settings.templates;return"function"==typeof v?void v(b):void ("string"==typeof v?h.send({url:v,success:function(w){b(r.parse(w))}}):b(v))}}function t(z){function y(A){function C(D){if(D.indexOf("<html>")==-1){var G="";q.each(a.contentCSS,function(H){G+='<link type="text/css" rel="stylesheet" href="'+a.documentBaseURI.toAbsolute(H)+'">'});var F=a.settings.body_class||"";F.indexOf("=")!=-1&&(F=a.getParam("body_class","","hash"),F=F[a.id]||""),D="<!DOCTYPE html><html><head>"+G+'</head><body class="'+F+'">'+D+"</body></html>"}D=d(D,"template_preview_replace_values");var E=x.find("iframe")[0].getEl().contentWindow.document;E.open(),E.write(D),E.close()}var B=A.control.value();B.url?h.send({url:B.url,success:function(D){w=D,C(w)}}):(w=B.content,C(w)),x.find("#description")[0].text(A.control.value().description)}var x,w,v=[];if(!z||0===z.length){var b=a.translate("No templates defined.");return void a.notificationManager.open({text:b,type:"info"})}q.each(z,function(A){v.push({selected:!v.length,text:A.title,value:{url:A.url,content:A.content,description:A.description}})}),x=a.windowManager.open({title:"Insert template",layout:"flex",direction:"column",align:"stretch",padding:15,spacing:10,items:[{type:"form",flex:0,padding:0,items:[{type:"container",label:"Templates",items:{type:"listbox",label:"Templates",name:"template",values:v,onselect:y}}]},{type:"label",name:"description",label:"Description",text:"\xa0"},{type:"iframe",flex:1,border:1}],onsubmit:function(){c(!1,w)},minWidth:Math.min(g.DOM.getViewPort().w,a.getParam("template_popup_width",600)),minHeight:Math.min(g.DOM.getViewPort().h,a.getParam("template_popup_height",500))}),x.find("listbox")[0].fire("select")}function s(b,A){function z(C,B){if(C=""+C,C.length<B){for(var D=0;D<B-C.length;D++){C="0"+C}}return C}var y="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),x="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),w="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),v="January February March April May June July August September October November December".split(" ");return A=A||new Date,b=b.replace("%D","%m/%d/%Y"),b=b.replace("%r","%I:%M:%S %p"),b=b.replace("%Y",""+A.getFullYear()),b=b.replace("%y",""+A.getYear()),b=b.replace("%m",z(A.getMonth()+1,2)),b=b.replace("%d",z(A.getDate(),2)),b=b.replace("%H",""+z(A.getHours(),2)),b=b.replace("%M",""+z(A.getMinutes(),2)),b=b.replace("%S",""+z(A.getSeconds(),2)),b=b.replace("%I",""+((A.getHours()+11)%12+1)),b=b.replace("%p",""+(A.getHours()<12?"AM":"PM")),b=b.replace("%B",""+a.translate(v[A.getMonth()])),b=b.replace("%b",""+a.translate(w[A.getMonth()])),b=b.replace("%A",""+a.translate(x[A.getDay()])),b=b.replace("%a",""+a.translate(y[A.getDay()])),b=b.replace("%%","%")}function e(b){var w=a.dom,v=a.getParam("template_replace_values");q.each(w.select("*",b),function(x){q.each(v,function(y,z){w.hasClass(x,z)&&"function"==typeof v[z]&&v[z](x)})})}function d(b,v){return q.each(a.getParam(v),function(w,x){"function"==typeof w&&(w=w(x)),b=b.replace(new RegExp("\\{\\$"+x+"\\}","g"),w)}),b}function c(v,A){function z(C,B){return new RegExp("\\b"+B+"\\b","g").test(C.className)}var y,x,w=a.dom,b=a.selection.getContent();A=d(A,"template_replace_values"),y=w.create("div",null,A),x=w.select(".mceTmpl",y),x&&x.length>0&&(y=w.create("div",null),y.appendChild(x[0].cloneNode(!0))),q.each(w.select("*",y),function(B){z(B,a.getParam("template_cdate_classes","cdate").replace(/\s+/g,"|"))&&(B.innerHTML=s(a.getParam("template_cdate_format",a.getLang("template.cdate_format")))),z(B,a.getParam("template_mdate_classes","mdate").replace(/\s+/g,"|"))&&(B.innerHTML=s(a.getParam("template_mdate_format",a.getLang("template.mdate_format")))),z(B,a.getParam("template_selected_content_classes","selcontent").replace(/\s+/g,"|"))&&(B.innerHTML=b)}),e(y),a.execCommand("mceInsertContent",!1,y.innerHTML),a.addVisual()}a.addCommand("mceInsertTemplate",c),a.addButton("template",{title:"Insert template",onclick:u(t)}),a.addMenuItem("template",{text:"Template",onclick:u(t),context:"insert"}),a.on("PreProcess",function(b){var v=a.dom;q.each(v.select("div",b.node),function(w){v.hasClass(w,"mceTmpl")&&(q.each(v.select("*",w),function(x){v.hasClass(x,a.getParam("template_mdate_classes","mdate").replace(/\s+/g,"|"))&&(x.innerHTML=s(a.getParam("template_mdate_format",a.getLang("template.mdate_format"))))}),e(w))})})}),function(){}}),o("0")()}();